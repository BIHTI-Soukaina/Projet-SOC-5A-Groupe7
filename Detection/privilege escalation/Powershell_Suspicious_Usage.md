# Description

Cette règle détecte les commandes PowerShell suspectes exécutées par des comptes standards utilisant l'option "Bypass", ce qui peut indiquer une tentative de contourner les contrôles de sécurité et d'escalader les privilèges.

# Criticité : **HIGH**

# Outils

WinEventLog

# Règle SPL

```
index=connectix sourcetype=WinEventLog EventCode=4688
| search New_Process_Name="*powershell.exe" Process_Command_Line="*Bypass*" NOT Account_Name IN ("frank", "olivia", "alice", "yara", "david", "katherine", "uma", "SRV-PRD-DC$", "SRV-PRD-WEB$", "SRV-PRD-DB$", "SRV-PRD-SHARE$")
| table _time host source sourcetype Account_Name ComputerName Process_Command_Line
| sort -_time
```

# Règle SIGMA

```
title: Detection of Suspicious PowerShell Usage by Standard Accounts
id: f0d7b391-50f2-4bcf-b88d-powershellsuspicious
status: experimental
description: This rule detects suspicious PowerShell commands executed by standard accounts using the "Bypass" flag, which could indicate an attempt to bypass security controls and escalate privileges.
author: Generated by System
date: 2024-11-09
tags:
  - attack.execution
  - attack.t1059.001
logsource:
  product: windows
  category: process_creation
  service: security
detection:
  selection:
    EventID: 4688
    New_Process_Name: '*powershell.exe'
    Process_Command_Line: '*Bypass*'
    Account_Name:
      - '!frank'
      - '!olivia'
      - '!alice'
      - '!yara'
      - '!david'
      - '!katherine'
      - '!uma'
      - '!SRV-PRD-DC$'
      - '!SRV-PRD-WEB$'
      - '!SRV-PRD-DB$'
      - '!SRV-PRD-SHARE$'
  condition: selection
falsepositives:
  - Legitimate use of PowerShell with "Bypass" flag by authorized personnel for administrative purposes.
level: high
```

# Explication

Cette règle détecte l'utilisation suspecte de PowerShell avec le flag "Bypass" par des comptes standards, ce qui pourrait indiquer une tentative de contournement des contrôles de sécurité. En surveillant ces événements, cette règle aide à identifier des activités potentiellement malveillantes et à prendre des mesures de remédiation appropriées.

