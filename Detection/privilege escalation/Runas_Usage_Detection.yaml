title: Detection of Suspicious Runas Usage by Standard Accounts
id: e5c58a91-08b7-4e21-baf1-runasusage
status: experimental
logsource:
  product: windows
  service: security
  eventid: 4648
selection:
  Process_Name:
    - '*runas*'
  Account_Name:
    - '!frank'
    - '!olivia'
    - '!alice'
    - '!yara'
    - '!david'
    - '!katherine'
    - '!uma'
    - '!SRV-PRD-DC$'
    - '!SRV-PRD-WEB$'
    - '!SRV-PRD-DB$'
    - '!SRV-PRD-SHARE$'

fields:
  - host
  - source
  - sourcetype
  - Account_Name
  - ComputerName
  - Process_Name
  - timestamp

description: >
  This rule detects the usage of Runas by standard accounts, which may indicate an attempt to escalate privileges.
  Runas allows users to execute commands with elevated privileges, and unauthorized usage could be a sign of suspicious activity.

detection:
  selection:
    EventID: 4648
    Process_Name: '*runas*'
    Account_Name:
      - '!frank'
      - '!olivia'
      - '!alice'
      - '!yara'
      - '!david'
      - '!katherine'
      - '!uma'
      - '!SRV-PRD-DC$'
      - '!SRV-PRD-WEB$'
      - '!SRV-PRD-DB$'
      - '!SRV-PRD-SHARE$'
  condition: selection

tags:
  - attack.privilege_escalation
  - attack.t1078
  - impact.medium

librairie_de_pivots:
  - Hostname of the affected machine
  - Account attempting to use Runas
  - Process that was attempted to be executed with elevated privileges

fiche_reflexe_remediation:
  - Restrict the use of Runas to authorized accounts only.
  - Monitor for any unusual Runas activity by standard accounts.
  - Investigate accounts attempting to use Runas without appropriate privileges and take necessary actions.

ttl: 3600
