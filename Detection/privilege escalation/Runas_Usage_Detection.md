# Description

Cette règle détecte l'utilisation de Runas par des comptes standards, ce qui peut indiquer une tentative d'escalade de privilèges. Runas permet aux utilisateurs d'exécuter des commandes avec des privilèges élevés, et une utilisation non autorisée peut être un signe d'activité suspecte.

# Criticité : **MEDIUM**

# Outils

WinEventLog

# Règle SPL

```
index=connectix sourcetype=WinEventLog EventCode=4648
| search Process_Name="*runas*" NOT Account_Name IN ("frank", "olivia", "alice", "yara", "david", "katherine", "uma", "SRV-PRD-DC$", "SRV-PRD-WEB$", "SRV-PRD-DB$", "SRV-PRD-SHARE$")
| table _time host source sourcetype Account_Name ComputerName Process_Name
| sort -_time
```

# Règle SIGMA

```
title: Detection of Suspicious Runas Usage by Standard Accounts
id: e5c58a91-08b7-4e21-baf1-runasusage
status: experimental
description: This rule detects the usage of Runas by standard accounts, which may indicate an attempt to escalate privileges. Runas allows users to execute commands with elevated privileges, and unauthorized usage could be a sign of suspicious activity.
author: Generated by System
date: 2024-11-09
tags:
  - attack.privilege_escalation
  - attack.t1078
logsource:
  product: windows
  category: authentication
  service: security
detection:
  selection:
    EventID: 4648
    Process_Name: '*runas*'
    Account_Name:
      - '!frank'
      - '!olivia'
      - '!alice'
      - '!yara'
      - '!david'
      - '!katherine'
      - '!uma'
      - '!SRV-PRD-DC$'
      - '!SRV-PRD-WEB$'
      - '!SRV-PRD-DB$'
      - '!SRV-PRD-SHARE$'
  condition: selection
falsepositives:
  - Legitimate use of Runas by authorized personnel for administrative purposes.
level: medium
```

# Explication

Cette règle détecte l'utilisation suspecte de Runas par des comptes standards, ce qui pourrait indiquer une tentative d'escalade de privilèges. En surveillant ces événements, cette règle aide à identifier des activités inhabituelles et à prendre des mesures de remédiation appropriées.

