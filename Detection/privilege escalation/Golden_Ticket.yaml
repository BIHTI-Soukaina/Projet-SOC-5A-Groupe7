title: Detection of Potential Golden Ticket Attack
id: b5e9c8f3-9874-46d8-a6d8-goldenticket
status: experimental
logsource:
  product: windows
  service: security
  eventid: 4768
selection:
  Ticket_Options: '0x40810000'
  Account_Name:
    - '!frank'
    - '!olivia'
    - '!alice'
    - '!yara'
    - '!david'
    - '!katherine'
    - '!uma'
    - '!SRV-PRD-DC$'
    - '!SRV-PRD-WEB$'
    - '!SRV-PRD-DB$'
    - '!SRV-PRD-SHARE$'

fields:
  - host
  - source
  - sourcetype
  - Account_Name
  - ComputerName
  - Ticket_Options
  - timestamp

description: >
  This rule detects potential Golden Ticket attacks by identifying abnormal Ticket_Options values. Golden Ticket attacks exploit Kerberos tickets to gain prolonged elevated access to resources.

detection:
  selection:
    EventID: 4768
    Ticket_Options: '0x40810000'
    Account_Name:
      - '!frank'
      - '!olivia'
      - '!alice'
      - '!yara'
      - '!david'
      - '!katherine'
      - '!uma'
      - '!SRV-PRD-DC$'
      - '!SRV-PRD-WEB$'
      - '!SRV-PRD-DB$'
      - '!SRV-PRD-SHARE$'
  condition: selection

tags:
  - attack.credential_access
  - attack.t1558.001
  - impact.high

librairie_de_pivots:
  - Hostname of the affected machine
  - Account requesting the Kerberos ticket
  - Ticket options used

fiche_reflexe_remediation:
  - Monitor for suspicious Kerberos ticket activity, especially with unusual ticket options.
  - Restrict access to Kerberos Ticket Granting Ticket (TGT) accounts and enforce multi-factor authentication.
  - Investigate any accounts associated with suspicious ticket requests and take necessary actions to mitigate risks.

ttl: 3600
