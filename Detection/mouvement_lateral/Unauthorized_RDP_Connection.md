# Description

Cette règle détecte des connexions Remote Desktop Protocol (RDP) non autorisées par des comptes non autorisés. Un accès RDP non autorisé peut indiquer une tentative de contrôle à distance de la machine et une élévation de privilèges.

# Criticité : **HIGH**

# Outils

WinEventLog

# Règle SPL

```
index=connectix sourcetype=WinEventLog EventCode=4624 Logon_Type=10
| search NOT Account_Name IN ("frank", "olivia", "alice", "yara", "david", "katherine", "uma", "SRV-PRD-DC$", "SRV-PRD-WEB$", "SRV-PRD-DB$", "SRV-PRD-SHARE$")
| table _time host source sourcetype Account_Name ComputerName
| sort -_time
```

# Règle SIGMA

```
title: Detection of Unauthorized RDP Connection by Non-Authorized Accounts
id: b3c5f8d9-8d6c-4e21-bb7a-rdpconnection
status: experimental
description: This rule detects unauthorized Remote Desktop Protocol (RDP) connections by non-authorized accounts. Unauthorized RDP access may indicate an attempt to remotely control the machine and escalate privileges.
author: Generated by System
date: 2024-11-09
tags:
  - attack.lateral_movement
  - attack.t1021.001
logsource:
  product: windows
  category: authentication
  service: security
detection:
  selection:
    EventID: 4624
    Logon_Type: 10
    Account_Name:
      - '!frank'
      - '!olivia'
      - '!alice'
      - '!yara'
      - '!david'
      - '!katherine'
      - '!uma'
      - '!SRV-PRD-DC$'
      - '!SRV-PRD-WEB$'
      - '!SRV-PRD-DB$'
      - '!SRV-PRD-SHARE$'
  condition: selection
falsepositives:
  - Legitimate RDP use by authorized personnel for maintenance or support.
level: high
```

# Explication

Cette règle permet de détecter des connexions RDP non autorisées effectuées par des comptes qui ne sont pas censés accéder à distance à la machine, ce qui pourrait indiquer une tentative d'escalade de privilèges ou un mouvement latéral par un attaquant.

