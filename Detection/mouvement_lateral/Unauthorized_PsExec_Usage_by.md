# Description

Cette règle détecte l'utilisation de PsExec par des comptes non administratifs, ce qui peut indiquer un mouvement latéral par un attaquant tentant d'exécuter des commandes à distance.

# Criticité : **HIGH**

# Outils

WinEventLog

# Règle SPL

```
index=connectix sourcetype=WinEventLog EventCode=7045
| search Service_Name="*PSEXESVC*" NOT Account_Name IN ("frank", "olivia", "alice", "yara", "david", "katherine", "uma", "SRV-PRD-DC$", "SRV-PRD-WEB$", "SRV-PRD-DB$", "SRV-PRD-SHARE$")
| table _time host source sourcetype Account_Name ComputerName
| sort -_time
```

# Règle SIGMA

```
title: Detection of Unauthorized PsExec Usage by Non-Administrative Accounts
id: b47e9a50-36c2-4c6b-bfd1-psexec
status: experimental
description: This rule detects the use of PsExec by non-administrative accounts, which could indicate lateral movement by an attacker attempting to execute commands remotely.
author: Generated by System
date: 2024-11-09
tags:
  - attack.execution
  - attack.t1047
logsource:
  product: windows
  category: process_creation
  service: security
detection:
  selection:
    EventID: 7045
    Service_Name: '*PSEXESVC*'
    Account_Name:
      - '!frank'
      - '!olivia'
      - '!alice'
      - '!yara'
      - '!david'
      - '!katherine'
      - '!uma'
      - '!SRV-PRD-DC$'
      - '!SRV-PRD-WEB$'
      - '!SRV-PRD-DB$'
      - '!SRV-PRD-SHARE$'
  condition: selection
falsepositives:
  - Legitimate use of PsExec for maintenance or troubleshooting by authorized personnel.
level: high
```

# Explication

Cette règle permet de détecter l'utilisation de PsExec par des comptes non administratifs, ce qui pourrait indiquer une tentative de mouvement latéral par un attaquant visant à exécuter des commandes à distance sur le système.