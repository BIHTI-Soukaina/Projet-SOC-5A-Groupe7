# Description

Cette règle détecte l'utilisation de Windows Management Instrumentation (WMI) pour exécuter des commandes à distance. L'utilisation de WMI pour l'exécution de commandes à distance est une technique couramment utilisée par les attaquants pour le mouvement latéral ou le contrôle à distance d'un système.

# Criticité : **HIGH**

# Outils

WinEventLog

# Règle SPL

```
index=connectix sourcetype=WinEventLog EventCode=4688 New_Process_Name="*wmic.exe" Process_Command_Line="*process call create*"
| table _time host source sourcetype Account_Name ComputerName
| sort -_time
```

# Règle SIGMA

```
title: Detection of WMI Usage for Remote Command Execution
id: b3e8c4d5-78a4-4f5b-92f5-wmicremoteexec
status: experimental
description: This rule detects the use of Windows Management Instrumentation (WMI) to execute commands remotely. The use of WMI for remote command execution is a common technique used by attackers for lateral movement or remote system control.
author: Generated by System
date: 2024-11-09
tags:
  - attack.execution
  - attack.t1047
logsource:
  product: windows
  category: process_creation
  service: security
detection:
  selection:
    EventID: 4688
    New_Process_Name: '*wmic.exe'
    Process_Command_Line: '*process call create*'
  condition: selection
falsepositives:
  - Utilisation légitime de WMI par des administrateurs pour la gestion à distance.
level: high
```

# Explication

Cette règle permet de détecter des tentatives d'utilisation de WMI pour exécuter des commandes à distance. L'exécution de commandes à distance via WMI par des comptes non autorisés peut indiquer un mouvement latéral ou une tentative de prise de contrôle malveillant sur la machine. Il est essentiel de surveiller ces activités pour prévenir toute attaque potentielle.