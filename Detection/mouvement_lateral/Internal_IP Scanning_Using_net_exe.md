# Description

Cette règle détecte l'utilisation de la commande `net view` pour découvrir des adresses IP et des ressources partagées sur le réseau, indiquant une possible reconnaissance en préparation d'un mouvement latéral.

# Criticité : **MEDIUM**

# Outils

WinEventLog

# Règle SPL

```
index=connectix sourcetype=WinEventLog EventCode=5145
| search Process_Command_Line="*net view*" Object_Name="*\\system32\\net.exe*"
| table _time host source sourcetype Account_Name ComputerName
| sort -_time
```

# Règle SIGMA

```
title: Detection of Internal IP Scanning Using net.exe
id: f56a9f00-5242-4e1c-a8e3-ipscan
status: experimental
description: This rule detects the use of the command `net view` to discover IP addresses and shared resources on the network, indicating possible reconnaissance in preparation for lateral movement.
author: Generated by System
date: 2024-11-09
tags:
  - attack.discovery
  - attack.t1018
logsource:
  product: windows
  category: file_access
  service: security
detection:
  selection:
    EventID: 5145
    Process_Command_Line: '*net view*'
    Object_Name: '*\\system32\\net.exe*'
  condition: selection
falsepositives:
  - Legitimate use of network commands for administrative or maintenance purposes.
level: medium
```

# Explication

Cette règle permet de détecter l'utilisation de la commande `net view` par des comptes non autorisés pour découvrir des adresses IP et des ressources partagées, ce qui peut être une indication de reconnaissance en préparation d'un mouvement latéral.

